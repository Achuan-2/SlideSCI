# SlideSCI Development Guide

This repository hosts a **PowerPoint VSTO Add-in** built with **.NET Framework 4.7.2**.

## 1. Build & Test

### Build
This is a legacy .NET Framework project using `packages.config`.
- **Command**: `msbuild SlideSCI/SlideSCI.csproj /t:Build /p:Configuration=Debug`
- **Note**: Requires Visual Studio Build Tools with "Office/SharePoint development" workload (VSTO).
- **Dependencies**: Managed via `packages.config`. Restore using `nuget restore SlideSCI.sln` if needed.

### Tests
- **Status**: No unit test projects currently exist in the repository.
- **Guideline**: When adding logic that is decoupled from PowerPoint Interop (e.g., parsers, converters), prefer creating a standard NUnit/xUnit project targeting .NET Framework 4.7.2.

## 2. Code Style & Conventions

### General
- **Language**: C# 7.x+ (limited by .NET Framework 4.7.2 support).
- **Encoding**: UTF-8.
- **Formatting**: Visual Studio default (Allman style - braces on new lines).

### Naming
- **Classes/Methods/Properties**: `PascalCase`
- **Private Fields**: `camelCase` (e.g., `themeColors`, `languagePatterns`)
- **Parameters/Locals**: `camelCase`
- **Constants**: `PascalCase` or `ALL_CAPS` (prefer PascalCase for public constants)

### Structure
- **Namespaces**: `SlideSCI` is the root namespace.
- **Imports**: System namespaces first, then third-party, then project namespaces.
- **Files**: One class per file usually.

### Comments & Documentation
- **Language**: The codebase uses **Chinese (Simplified)** for comments (e.g., `// 蓝色`, `// 注释 - 放在最前面优先匹配`). Maintain this pattern for internal logic comments if consistent with the context, otherwise English is acceptable.
- **XML Documentation**: Use `///` for public APIs.

### PowerPoint Interop
- **Safety**: Always release COM objects if necessary, though VSTO manages `ThisAddIn` lifecycle.
- **Threading**: UI operations must run on the main thread.
- **Error Handling**: Wrap Interop calls in `try-catch` blocks where COM exceptions are expected (e.g., RPC server unavailable).

## 3. Architecture

- **Entry Point**: `ThisAddIn.cs` - Handles Startup/Shutdown.
- **UI**: `Ribbon1.cs` (Ribbon XML/Designer) - Handles Ribbon button clicks.
- **Logic**: Separate logic into helper classes (e.g., `CodeHighlighter.cs`, `LatexToSvgConverter.cs`) to avoid bloating the Ribbon or AddIn classes.
- **External Tools**:
  - `latex-converter/`: Contains Node.js scripts for LaTeX to SVG conversion.
  - `assets/`: Static resources.

## 4. Workflows

### Adding a New Feature
1. **UI**: Add button to `Ribbon1.cs` / `Ribbon1.xml`.
2. **Logic**: Implement the logic in a separate class.
3. **Integration**: Call the logic from the Ribbon event handler.

### Dependencies
- **NuGet**: Use `packages.config`.
- **Node.js**: Some features (LaTeX SVG) require a local Node.js environment.

---
*Generated by OpenCode Sisyphus*
